```{r set-options, echo = FALSE, cache = FALSE, external = TRUE}
opts_chunk$set(external = TRUE, cache = TRUE, cache.path = "bevholt-cache/")
read_chunk('gaussian-process-control.R')
library(knitcitations)
```


```{r libraries, include=FALSE}
```

```{r graphing-options, include=FALSE}
```

```{r BevHolt}
```




We use the model of `r citet("10.1126/science.269.5227.1106")`.


```{r sdp-pars-bh}
sigma_g <- 0.02
z_g <- function(sigma_g) rlnorm(1, 0, sigma_g) #1+(2*runif(1, 0,  1)-1)*sigma_g #
x_grid <- seq(0, 1.5 * K, length=101)
h_grid <- x_grid
profit = function(x,h) pmin(x, h)
delta <- 0.01
OptTime = 20
xT = 0
reward = profit(x_grid[length(x_grid)], x_grid[length(x_grid)]) + 1 / (1 - delta) ^ OptTime 
## x_0_observed is starting condition for simulation of the observed data.  
## It should be in preferred state for bistable model, 
## above Allee threshold for Allee model, 
## and near zero for BH or Ricker models
x_0_observed <- x_grid[2] 
```

With parameters `r p`. 

```{r sim-obs}
```

```{r lag-data}
```

```{r par-est}
```



```{r gp-fit, dependson="lag-data"}
```

We fit a Gaussian process with 

```{r gp-data, dependson="gp-fit"}
```

```{r gp-plot, dependson="gp-data"}
```


## The transition matrix of the inferred process

```{r persistence-test}
```

```{r gp-F-sim, dependson=c("persistence-test", "gp-data")}
```

```{r par-F-sim, dependson="persistence-test"}
```

```{r F-sim-plot, dependson=c("gp-F-sim", "par-F-sim")}
```

```{r est-F-sim, dependson="persistence-test"}
```


```{r gp-opt, dependson="gp-data"}
```

```{r true-opt}
```

```{r est-opt}
```


```{r policy_plot}
```


```{r othernoise}
```

```{r simulate}
```


```{r tidy}
```


```{r sim-fish}
```


```{r sim-harvest}
```

```{r costs}
```

```{r echo=FALSE, results="asis"}
bibliography("html")
```
